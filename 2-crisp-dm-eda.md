---
marp: true
theme: default
style: |
    section {
        font-family: 'Arial', sans-serif;
        font-size: 20px;
    }
    .columns {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 1rem;
    }
    .small-text {
        font-size: 20px;
    }
header: CRISP-DM, EDA
footer: БГУ ФПМИ ФМИиС
---

<!-- _class: lead -->

# **CRISP-DM & EDA: Системный подход к решению Data Science задач**

![bg right:40% w:400](https://miro.medium.com/v2/resize:fit:1400/1*_NVB9QZkY5ZALjkcINhGyw.png)

---

## 

**Часть 1: CRISP-DM — стандартная методология**
1. Введение в CRISP-DM
2. Бизнес-понимание (Business Understanding)
3. Понимание данных (Data Understanding)
4. Подготовка данных (Data Preparation)
5. Моделирование (Modeling)
6. Оценка (Evaluation)
7. Внедрение (Deployment)
8. Природа цикла CRISP-DM

**Часть 2: EDA — Искусство исследования данных**
9. Что такое EDA?
10. Цели и философия EDA
11-18. Методы и примеры EDA
19. Связь CRISP-DM и EDA
20. Заключение

---

## Что такое CRISP-DM?

**Cross-Industry Standard Process for Data Mining** — кросс-индустриальный стандартный процесс для интеллектуального анализа данных.

- **Не алгоритм, а методология**: Структурированный, итеративный подход к проектам по машинному обучению
  - Повышает шансы на успех проекта
  - Делает процесс предсказуемым, управляемым и воспроизводимым
  - Универсален для любых индустрий

---

## Этап 1. Бизнес-понимание (Business Understanding)

**Самый важный этап: Зачем мы это делаем?**

**Цель**: Полностью понять бизнес-задачи и цели проекта

**Ключевые действия**:
- Определение бизнес-целей (например, снизить отток клиентов на 15%)
- Определение целей Data Mining (классификация: предсказание, какой клиент уйдет)
- Составление плана проекта: Ресурсы, сроки, риски

**Результат**: Утвержденное техническое задание (ТЗ\Justification) с критериями успеха (KPI\Definition of Done)

**Ошибка**: Создать точную, но бесполезную для бизнеса модель

---

## Этап 2. Понимание данных (Data Understanding)

**Знакомство с нашими данными**

**Цель**: Собрать первичные данные и выявить первые инсайты

**Ключевые действия**:
- Сбор данных из всех доступных источников (SQL, Google Analytics, CRM)
- Описательный анализ: `df.describe()` - начальные статистики
- Визуальный осмотр: `df.head()`, `df.info()`
- Поиск проблем: Пропуски, выбросы, некорректные форматы
- Верификация качества данных

**Результат**: Отчет о качестве данных, первые гипотезы

---

## Этап 3. Подготовка данных (Data Preparation)

**Самая трудоемкая часть проекта (~80% времени)**

**Цель**: Превратить "сырые" данные в чистый набор признаков

**Ключевые действия**:
- Очистка: Заполнение пропусков, обработка выбросов
- Кодирование: One-Hot, Label Encoding для категориальных признаков
- Масштабирование: StandardScaler, MinMaxScaler
- Feature Engineering: Создание новых признаков
- Сборка финального датасета: Разделение на train/test

**Результат**: Чистый, готовый к моделированию датасет

![bg right:40% w:450](https://avatars.mds.yandex.net/get-lpc/1220100/b2fc88e6-1dd7-4966-9919-81472946ebec/width_360_q70)

---

## Этап 4. Моделирование (Modeling)

**Этап, который все ждут**

Выбор и обучение подходящих алгоритмов ML

**Ключевые действия**:
- Выбор алгоритмов: Исходя из задачи (дерево решений, линейная регрессия)
- Обучение моделей: `model.fit(X_train, y_train)`
- Настройка гиперпараметров: GridSearch, RandomSearch
- Валидация: Оценка качества на кросс-валидации

**Результат**: Набор обученных моделей с оценкой производительности

> "Мусор на входе -> мусор на выходе"


---

## Этап 5. Оценка (Evaluation)

**А модель вообще что-то умеет?**

**Цель**: Оценить качество модели и проверить достижение бизнес-целей

- Тестирование на отложенной выборке
- Анализ и осмысление метрик качества 
- Ответ на вопрос: Решает ли модель бизнес-задачу?
- Ранжирование моделей: Выбор лучшей из нескольких

**Результат**: Подтверждение готовности к внедрению или возврат на предыдущие этапы


---

## Этап 6. Внедрение (Deployment)

Интегрирование модели в бизнес-процессы

**Ключевые действия**:
- Пайплайн: Автоматизация процесса
- Интеграция: Внедрение в продукт, CRM-систему или дашборд
- Мониторинг: Контроль качества модели с течением времени
- Поддержка и сопровождение: Обновление модели

**Результат**: Работающая система, основанная на ML

Многие проекты не доходят до реального внедрения)

![bg right:40% w:400](https://cs13.pikabu.ru/post_img/big/2024/02/02/6/170686112713044552.png)

---

## Природа цикла CRISP-DM

**CRISP-DM — это не линейный процесс, а цикл**

**Итеративность**: В любой момент можно вернуться на предыдущий этап
- Пример: На этапе "Моделирование" выяснилось, что не хватает данных
- Пример: На этапе "Оценка" модель не достигает цели

**Не существует идеального прохождения**: Циклы и возвраты — это норма

**Постоянное уточнение**: Понимание и данных, и бизнес-задачи углубляется


---

# Что такое EDA? (Exploratory Data Analysis)

**Определение**: Подход к анализу данных, основанный на визуализации и статистике для выявления закономерностей до применения сложных моделей

> "Посмотри на данные!" (Джон Тьюки)

**Основная цель**: Почувствовать данные, понять их структуру и взаимосвязи

**Главный инструмент**: Визуализация и описательная статистика

**Когда проводится?**: На этапах Понимания и Подготовки данных CRISP-DM

---

# Зачем нужно проводить EDA?

- Обнаружение закономерностей: Тренды, связи между переменными
- Выявление аномалий: Выбросы, ошибки в данных, пропуски
- Проверка предположений: Гипотезы о данных для выбора моделей
- Формирование гипотез: Идеи для feature engineering
- Подготовка к моделированию: Выбор подходящих алгоритмов

**Ключевой принцип**: Максимальная простота и наглядность

---

# EDA: Анализ отдельных переменных (Univariate Analysis)

**Для числовых признаков**:
- Статистики: min, max, mean, median, std, quantiles
- Визуализация: Гистограмма (форма распределения), Ящик с усами (выбросы)

**Для категориальных признаков**:
- Статистики: Частоты, доли каждой категории
- Визуализация: Столбчатая диаграмма

**Что ищем?**: Нормальное/ненормальное распределение, скос, выбросы, дисбаланс классов

![bg vertical right:40% w:400](https://pyodps.readthedocs.io/en/latest/_images/df-plot-iris-hist.png)
![bg right:40% w:400](https://media.geeksforgeeks.org/wp-content/uploads/20200716120515/Screenshot342.png)

---

## EDA: Анализ взаимосвязей переменных (Bivariate/Multivariate Analysis)

**Числовая vs Числовая**:
- Визуализация: Диаграмма рассеяния, Heatmap корреляции

**Категориальная vs Числовая**:
- Визуализация: Boxplot по группам, Violin plot

**Категориальная vs Категориальная**:
- Визуализация: Сгруппированная столбчатая диаграмма

**Что ищем?**: Линейные и нелинейные зависимости, наличие кластеров

![bg right:40% w:380](https://cdn.analyticsvidhya.com/wp-content/uploads/2024/10/1_5NKuFx60PNUFPDKT9CN-GA.webp)

---

## EDA: Работа с пропусками (Missing Values)

**Цель**: Оценить масштаб проблемы и решить, как обрабатывать пропуски

**Методы анализа**:
- Визуализация: Heatmap пропусков (библиотека missingno)
- Статистика: Процент пропусков в каждом столбце

**Типы пропусков**:
- MCAR: Пропуски совершенно случайны
- MAR: Пропуски зависят от других переменных
- MNAR: Пропуски не случайны (самая сложная ситуация)

**Пример**: "В столбце 'Income' 5% пропусков. Создать флаг 'is_income_missing'"

![bg right:40% w:380](https://media.geeksforgeeks.org/wp-content/uploads/20210326114049/1.PNG)

---

## EDA: Анализ выбросов (Outliers Analysis)

**Цель**: Найти аномальные наблюдения и решить, что с ними делать

**Методы обнаружения**:
- Визуальные: Boxplot, scatter plot
- Статистические: Z-score, IQR (Interquartile Range)

**Важно**: Не удалять выбросы слепо!
- Ошибка измерения: (Например, возраст = 200) → удалить или исправить
- Настоящее, но редкое явление: (Зарплата CEO) → часто самые важные наблюдения!

![bg right:40% w:380](https://miro.medium.com/v2/resize:fit:1400/1*2c21SkzJMf3frPXPAR_gZA.png)

---

## EDA: Анализ временных рядов (Time Series Analysis)

**Цель**: Выявить временные паттерны

**Ключевые компоненты**:
- Тренд: Долгосрочное поведение
- Сезонность: Периодические колебания
- Шум: Случайная составляющая

**Методы визуализации**:
- Линейный график во времени
- Декомпозиция временного ряда
- Autocorrelation Function (ACF) Plot

**Что ищем?**: Наличие тренда, сезонности, стационарность ряда

![bg right:40% w:480](https://www.dtreg.com/uploaded/pageimg/TimeSeriesChart_1.jpg)

---

## EDA: Примеры полезных выводов

**От визуализации к бизнес-инсайту**

- "Клиенты из Москвы покупают на 40% чаще" → Фокусировать рекламу на другие регионы
- "Продажи падают в выходные дни" → Уменьшать число смен на выходных
- "Корреляция между временем на сайте и суммой чека" → Увеличивать engagement
- "90% ушедших пользователей из одной когорты" → Искать причину в изменениях продукта

---
## Заключение

**Выводы**

- CRISP-DM — надежный roadmap для успешного выполнения ML-проектов
- Этапы методологии итеративны и тесно связаны друг с другом
- EDA — !критически! важный набор техник для понимания данных
- Потратив время на бизнес-понимание и EDA - сэкономите силы на последующих этапах
- Сочетание структурированного подхода (CRISP-DM) и глубокого анализа (EDA) — ключ к успеху