---
marp: true
theme: default
style: |
    section { background-color: #fff; font-family: Arial, sans-serif; font-size:20px}
    h1 { color: #1c5fa8; }
    h2 { color: #2c75d6; }
    table { width: 100%; font-size: 0.9em; }
    footer { color: #666; font-size: 0.7em; }
header: Рекомендательные системы
footer: БГУ ФПМИ ФМИиС
paginate: true
---

<!-- _class: title -->
# **Рекомендательные системы: от теории к преодолению "холодного старта"**
### Коллаборативная фильтрация, матричные разложения и решение ключевых проблем
<br>
<br>
**ФИО докладчика**
**Организация**
**Дата**

![bg right:40% w:400](https://miro.medium.com/v2/resize:fit:1400/1*4k2lA0pU_tk4rUfWp5lVAQ.png)

---



1.  **Введение:** Зачем нужны рекомендации? Постановка задачи.
2.  **Коллаборативная фильтрация:** User-Based и Item-Based подходы.
3.  **Матричные разложения:** SVD и ALS.
4.  **Гибридные подходы.**
5.  **Проблема "холодного старта".**
6.  **Современные тренды (Neural, FAISS).**
7.  **Заключение.**

---

### **Часть 1: Введение**

## Зачем нужны рекомендательные системы?

*   **Пользовательский опыт:**
    *   Персонализация
    *   Упрощение выбора
    *   Обнаружение нового
*   **Бизнес-метрики:**
    *   **Удержание:** Делают продукт "липким".
    *   **Конверсия:** Продажа большего количества товаров.
    *   **Увеличение среднего чека:** Кросс-селл и ап-селл.

![bg right:40% w:400](https://storage.yandexcloud.net/cloud-news/wp-content/uploads/2023/10/recommendation-engines.jpg)

---

## Постановка задачи

*   **Дано:**
    *   Множество пользователей `U`.
    *   Множество items (товаров, фильмов, песен) `I`.
    *   Матрица взаимодействий `R [U x I]`.
*   **Задача:** Для пары (user, item) предсказать **оценку** или **вероятность взаимодействия**.
*   **Цель:** Найти для каждого пользователя **топ-N items**.

![Матрица пользователь-предмет](https://developers.google.com/static/machine-learning/recommendation/images/Matrix.svg?hl=ru)

---

## Типы данных и Фильтрации

*   **Явная обратная связь (Explicit Feedback):**
    *   Оценки, лайки.
    *   *Плюсы:* Понятны. *Минусы:* Мало данных, bias.
*   **Неявная обратная связь (Implicit Feedback):**
    *   Просмотры, клики, покупки.
    *   *Плюсы:* Много данных. *Минусы:* Шум.

**Типы подходов:**
*   **Контентная фильтрация:** На основе свойств items.
*   **Коллаборативная фильтрация (CF):** На основе поведения *других* пользователей. **Наша фокусная тема.**

---

### **Часть 2: Коллаборативная фильтрация**

## Идея Коллаборативной фильтрации

**Ключевой принцип:** "Схожие пользователи предпочитают схожие items".

**Два основных подхода:**
1.  **User-Based CF:** "Найди пользователей, похожих на меня..."
2.  **Item-Based CF:** "Найди товары, похожие на те, что мне нравятся..."

![bg right:40% w:400](https://miro.medium.com/v2/resize:fit:1000/1*6_XLr6KqxbG0+JZYJ5kE4Q.png)

---

## User-Based Collaborative Filtering

**Шаги:**
1.  Найти **k-наиболее похожих пользователей** (neighbors). Метрика: **Косинусная схожесть**.
2.  Вычислить **взвешенную среднюю оценку** от этих соседей.
3.  Рекомендовать items с самыми высокими предсказанными оценками.

**Проблема:** Вычислительно дорого для миллионов пользователей.

![Косинусная схожесть](https://www.saedsayad.com/images/Cosine_similarity.png)

---

## Item-Based Collaborative Filtering (Amazon)

**Шаги:**
1.  Вычислить попарные схожести **между items**.
2.  Для пользователя: посмотреть на его историю.
3.  Просуммировать схожести item'а с items из истории.

**Плюсы:**
*   Items меняются реже. Матрицу `Sim` можно пересчитывать нечасто.
*   Стабильнее и быстрее, чем User-Based.

![Item-Item Similarity](https://developers.google.com/static/machine-learning/recommendation/images/Item-item_model.svg?hl=ru)

---

## Проблемы "Наивной" Коллаборативной фильтрации

*   **Разреженность (Sparsity):** Матрица `R` на 99% пустая.
*   **Маcштабируемость:** Сложность `O(N^2)`.
*   **"Холодный старт" (Cold Start):** Нет данных для новых пользователей/items.

![Разреженная матрица](https://research.aimultiple.com/wp-content/uploads/2023/01/sparse-matrix-in-recommendation-system.png)

---

### **Часть 3: Матричные разложения**

## Идея Matrix Factorization (MF)

**Цель:** Преодолеть разреженность и повысить точность.
**Интуиция:** Представить и пользователей, и items в виде векторов в **едином латентном пространстве**.

**Латентные факторы:** Скрытые признаки (например, для фильмов: "степень серьёзности", "количество экшна").

![Латентное пространство](https://miro.medium.com/v2/resize:fit:1000/1*9WkXaaga2eMQOBnwV4P+2w.png)

---

## SVD (Singular Value Decomposition)

**Математическая основа:** `R = U * Σ * V^T`

*   `U` - связь пользователей с факторами.
*   `Σ` - важность каждого фактора.
*   `V^T` - связь items с факторами.

**Применение:** Берем усечённое разложение `R ≈ U_d * Σ_d * V_d^T`.

![SVD разложение](https://miro.medium.com/v2/resize:fit:720/format:webp/1*Y2lfNvW4cOQlLs13LgOqIA.png)

---

## ALS (Alternating Least Squares)

**Проблема:** В матрице `R` много пропусков. Классический SVD неприменим.
**Решение: ALS.**

**Алгоритм:**
1.  **Фиксируем** вектора items `Q`, оптимизируем для `P`.
2.  **Фиксируем** вектора пользователей `P`, оптимизируем для `Q`.
3.  Попеременно повторяем.

**Плюсы:** Отлично работает с разреженными матрицами, распараллеливается.

![ALS итерации](https://qph.cf2.quoracdn.net/main-qimg-5f9c5d661d159d19e3782a95a5d9bcf1-lq)

---

## Как выглядит предсказание?

*   У пользователя `u` есть вектор `p_u`.
*   У item'а `i` есть вектор `q_i`.
*   **Предсказанная оценка:** `r_ui_hat = p_u * q_i^T`
*   **Рекомендация:** Вычислить оценку для всех items, отсортировать, взять топ-N.

![Предсказание оценок](https://latex.codecogs.com/svg.image?%5Chat{r}_{ui}=p_u%5Ccdot%20q_i%5ET)

---

### **Часть 4: Гибридные подходы и Cold Start**

## Гибридные подходы

**Идея:** Комбинировать несколько методов (CF + Content-Based).

**Способы комбинирования:**
*   **Усреднение** предсказаний.
*   **Взвешивание** моделей.
*   **Feature Augmentation:** Признаки одной модели подаются на вход другой.

![Гибридная модель](https://www.researchgate.net/profile/Seyed-Amirhossein-Tabatabaei/publication/320007589/figure/fig2/AS:669956365418506@1536746510331/A-hybrid-recommender-system-architecture.png)

---

## Проблема "Холодного старта" (Cold Start)

**Суть:** Невозможно дать персонализированные рекомендации для новых пользователей или новых items.

**Три типа:**
1.  **Новый пользователь (User Cold Start).**
2.  **Новый item (Item Cold Start).**
3.  **Новая система (System Cold Start).**

![Холодный старт](https://www.researchgate.net/profile/Mohammad-Reza-Abbasi/publication/342217299/figure/fig1/AS:913716263829505@1594636492751/Cold-start-problem-in-recommender-systems-This-problem-is-divided-into-three-categories.jpg)

---

## Решение для User Cold Start

1.  **Неперсонализированные рекомендации:**
    *   Топ-N самых популярных items.
2.  **Сбор явных предпочтений:**
    *   Онбординг: "Выберите 5 любимых жанров".
3.  **Использование контекстной информации:**
    *   Геолокация, устройство, время суток.

![Onboarding](https://assets-global.website-files.com/5f6dffc97c9ae20a5e6e39ff/62548aecd4cf9c723a0b3006_62a7f7d9b4cbb93d8e604e6d_62a7f7d9b4cbb93d8e604e6d_1.png)

---

## Решение для Item Cold Start

1.  **Контентные признаки:**
    *   Использовать атрибуты item'а (описание, жанр, автор).
2.  **Рекомендация "по схожести контента":**
    *   Похожие товары на основе метаданных.
3.  **Продвижение новых items:**
    *   Скидки, пометка "Новинка".

![Content-Based](https://media.licdn.com/dms/image/D5612AQFvVHvWv-2tCg/article-cover_image-shrink_720_1280/0/1696320690414?e=2147483647&v=beta&t=H3Jw8-9NQ8Ww1f8-3_6pP1WQd3_2-4Z9q3Q0XqZJjU)

---

### **Часть 5: Современные тренды и заключение**

## Нейросетевые подходы (Neural CF)

**Идея:** Заменить скалярное произведение на нейронную сеть.
**Архитектура:** Two-Tower (Двухбашенная) модель.

*   **Одна "башня"** кодирует пользователя.
*   **Вторая "башня"** кодирует item.
*   Вектора объединяются для предсказания.

**Плюсы:** Учет нелинейных взаимодействий и side-информации.

![Two-Tower Model](https://miro.medium.com/v2/resize:fit:1400/1*A6-rtMpXrqukZC6UQM6cKw.png)

---

## Быстрый поиск соседей (FAISS)

**Проблема:** Как найти топ-N items из миллионов? Скалярное произведение со всеми — дорого.
**Решение:** **FAISS** (библиотека от Meta).

*   Строит эффективные структуры данных для **приближённого поиска ближайших соседей**.
*   **Результат:** Поиск за миллисекунды.

![FAISS](https://miro.medium.com/v2/resize:fit:1000/1*_1h4JfM_1ccvR0KjO2EyEg.png)

---

## Сравнительная таблица методов

| Метод | Плюсы | Минусы |
| :--- | :--- | :--- |
| **Item-Based CF** | Простота, стабильность | Холодный старт |
| **Matrix Factorization** | Точность, борьба с разреженностью | Холодный старт |
| **Гибридные модели** | Борьба с холодным стартом | Сложность |
| **Нейросети** | Максимальная точность | Сложность, данные |

---

## Ключевые выводы

1.  **Коллаборативная фильтрация** — ядро систем, основанное на "мудрости толпы".
2.  **Матричные разложения** — мощный инструмент для работы с разреженными данными.
3.  **Проблема "холодного старта"** решается через **гибридные подходы** и **контентные признаки**.
4.  Нет идеального алгоритма. Выбор зависит от **задачи и данных**.

---

## Что почитать?

*   **Классика:** "Recommender Systems: The Textbook" by Charu C. Aggarwal.
*   **Статья Netflix Prize:** "Matrix Factorization Techniques for Recommender Systems" (2009).
*   **Библиотеки Python:**
    *   `Surprise`, `Implicit`, `LightFM`, `TensorFlow Recommenders`.

![Книги и код](https://cdn.prod.website-files.com/5f6d9c6ce29d5d2d704c19e9/5fdc0b7499e56d6e5d0a7292_61a7f7d9b4cbb93d8e604e6d_61a7f7d9b4cbb93d8e604e6d_1.png)

---

## Вопросы?

![Questions](https://media.tenor.com/lx2WSGRk8bcAAAAC/puppy-big-eyes.png)
